<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=yes, initial-scale=1.0">
    <link rel="icon" href="http://culturenumerique.univ-lille3.fr/themes/cultnum/img/favicon.png" />
    <link rel="stylesheet" href="css/style.css" media="screen" />
    <script type="text/javascript" src="http://culturenumerique.univ-lille3.fr/plugins/jquery/jquery.min.js"></script>
    <script type="text/javascript" src="js/fancybox/jquery.fancybox.pack.js"></script>
    <link rel="stylesheet" href="css/fancybox/jquery.fancybox.css" type="text/css" media="screen" />
    <title>Culture Numérique | Présentation des modules de cours</title>
</head>

<body>
    <!--  HEADER -->
    <div id="container">
        <header>
            <h1>
                <a title="Culture Numérique" class="maintitle" href="http://culturenumerique.univ-lille3.fr">Culture Numérique</a>
            </h1>
            <h2>Site vitrine de présentation des modules de cours</h2>
        </header>
        <!-- Module Menu -->
        <nav class="module_menu">
            <ul id="static-nav">
                <li><a class="active" href="accueil.html">Accueil</a></li>
                <li><a href="module1.html">Internet</a></li>
                <li><a href="module2.html">Le Web</a></li>
            </ul>
        </nav>

      <div class="module_content">



      </div>
      <!-- SCRIPTs  -->
      <script type="text/javascript">
        // ## control of Navigation and sections/subsections toggling ##
        function navigation(){
            console.log(" loading navigation ???");
            $(".accordion ul li a").click(function(e){
                console.log("click on ",this)
                e.preventDefault();
                current_node = $(this);
                var selector = current_node.attr('data_sec_id');
                console.log('selector ='+selector+';');
                if (selector.length == 0) {
                    //go to 1st subsection if selected section is empty
                    current_node = current_node.next().find('a.subsection')[0];
                    selector = $(current_node).attr('data_sec_id');
                }
                // turn selected subsection active, if any
                if ($(current_node).hasClass('subsection')){
                    $('a.subsection').removeClass('active');
                    $(current_node).addClass('active');
                }
                // toggle selected section or subsection (they all use 'section' tag)
                $('section').hide();
                $('#'+selector).show();
                $(document).scrollTop(0);
                // if an iframe is in selected sec or subsec, rename attribute data-src to src
                var iframes = $('#'+selector).find('iframe');
                console.log("found iframes ?", iframes);
                iframes.each(function(idx){
                    if ($(this).data('src')){ // only do it once per iframe
                        $(this).prop('src', $(this).data('src')).data('src', false);
                        console.log("this src = ", $(this).attr('src'))
                        }
                })
            });
            // ## nav stays fixed on top when scroll pos > header height ##
            $(document).scroll(function(){
                var header_height = $('header').outerHeight();
                if (window.scrollY > header_height) {
                    $('nav.accordion').attr('style', 'position:fixed;top:0;margin-top:0;');
                }
                else {
                    $('nav.accordion').attr('style', '');
                }
            });
        };
        // ## Accordion menu: control folding and unfolding of selected sections (see above for content loading) ##
        function accordion(){
            (function ($) {
                console.log(" loading accordion ???");
                // adapt main content height to menu height to avoid overlap with footer
                var nav_height = $('nav.menu').outerHeight();
                $('main.content').attr('style', 'min-height:'+nav_height+'px;')
                // folding/unfolding mechanism
                $('.accordion > li:eq(0) a').addClass('active').next().slideDown();
                $('.accordion a.section').click(function(j) {
                    console.log("accordéon ====", $(this));
                    var dropDown = $(this).closest('li').find('p');
                    $(this).closest('.accordion').find('p').not(dropDown).slideUp();

                    if ($(this).hasClass('active')) {
                        $(this).removeClass('active');
                    } else {
                        $(this).closest('.accordion').find('a.section.active').removeClass('active');
                        $(this).addClass('active');
                    }
                    dropDown.stop(false, true).slideToggle();
                    j.preventDefault();
                });
            })(jQuery);
        }
        // ## Fancybox : used for video texts when clicking on text vignets ##
        function load_fancybox(){
            console.log(" loading Fancy box ???");
            $(".fancybox").fancybox({
                            padding : '1em',
                            maxWidth : '70%',
                            maxHeight : '90%',
                            fitToView : false,
                            width : '60%',
                            height : '80%',
                            autoSize : false,
                            closeClick : false,
                            openEffect : 'none',
                            closeEffect : 'none',
                            tpl: {
                                    next : '<a title="Next" class="fancybox-nav fancybox-next fancybox-wb-next" href="javascript:;"></a>',
                                    prev : '<a title="Previous" class="fancybox-nav fancybox-prev fancybox-wb-prev" href="javascript:;"></a>',
                                    closeBtn: '<a title="Close" class="fancybox-item fancybox-close fancybox-wb-close" href="javascript:;"></a>'
                            },
                            helpers : {
                                    overlay : {
                                        css : {
                                            'background' : 'rgba(255, 255, 255, 0.8)'
                                        }
                                    }
                            }
                            });
                        };

        // ## control of main modules navigation : load selected module and toggle tab-like navigation ##
        $(function(){
            // load accueil on start
            $('.module_content').load("accueil.html");
            $(".module_menu ul li a").click(function(e){
                e.preventDefault()
                $('.module_menu ul li a').removeClass('active');
                $(this).addClass('active');
                $('.module_content').load($(this).attr('href'), function(){
                    console.log("module loaded !");
                    navigation();
                    accordion();
                    load_fancybox();
                });
            });
        });
    </script>
      <footer>
        <a href="https://www.univ-lille3.fr/">
          <img src="svg/logo_lille3.svg" title="" alt="Lille 3" />
        </a>
        <p><a href="http://culturenumerique.univ-lille3.fr/" title="Culture Numérique">Culture Numérique</a> - 2015</p>
      </footer>
    </div>
    <!-- End of container-->
  </body>
</html>
